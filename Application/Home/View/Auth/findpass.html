<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>用户邮件激活-EZ4Agent</title>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/front/css/share.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/front/css/main.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/front/css/common.css">
<script src="__PUBLIC__/js/jquery.js" type="text/javascript"></script>
<script src="__PUBLIC__/front/js/area.js" type="text/javascript"></script>
<script src="__PUBLIC__/front/js/gobal.js" type="text/javascript"></script>
<!--[if lt IE 9]>
    <script src="__PUBLIC__/js/html5.js"></script>
<![endif]-->
</head>
<body>

<section class="main_wrap">
    <include file="Public:login-header" />
    <section class="banner_wrap">
        <div class="login_con">
            <div class="login_inner">
                <div class="login_made">
                    <div class="banner_box_inner findpass">
                        <h2>密码找回</h2>

                        <form method="post" id="findpass-form" autocomplete="off" action="" accept-charset="UTF-8">
                            <dl>
                                <dd class="inpt">
                                    <input type="text" class="input"  size="50" value=""  placeholder="请输入密码找回的邮箱地址" name="usermail">
                                    <div class="popover" id="nickname_tip"></div>
                                </dd>
                            </dl>
                            <div class="form-actions">
                                <a id="findpass_button" class="btn btn-primary" type="submit" onclick="return false;" href="#">发送邮件</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="banner_inner"><img src="__PUBLIC__/front/images/bannerImg.jpg" width="1680" height="704" alt="" /></div>
    </section>
    <include file="Public:footer" />
</section>


<script>
    $(function() {

        function show_err(name, msg) {
            var tip = $("#"+name + "_tip");
            tip.html(msg);
            tip.show();
        }

        function hide_err(name) {
            $("#"+name + "_tip").hide();
        }

        $('#findpass_button').on('click',function(){
            var user_email = $('#input_email').val();

            if ($.trim(user_email) == "")
                return show_err("email", "请输入密码找回的邮箱地址");

            if (!~user_email.indexOf("@"))
                return show_err("email", "邮箱格式不正确");

            var data = {
                email: user_email,
            };

            $.post("<?=U('Home/Auth/findpass')?>",data,function( json ) {

                if(json.error){
                    $('#signup_button').attr('disabled',false);

                    return show_err(json.label, json.message);
                }

                setTimeout(function() {
                    $('#redirect').val() != "" ? window.location.href = $('#redirect').val(): window.location.href = "/"
                },1e3);
            },'json');

        });

        $('#input_email').focus();

        $('#signup-form input').blur(function(){
            hide_err($(this).attr('name'));
        });

        $("disclaimer").click(function() {
            $(this).is(":checked") ? $('#signup_button').attr("disabled",false) : $('#signup_button').attr("disabled",true);
        });
    });
</script>
</body>
</html>